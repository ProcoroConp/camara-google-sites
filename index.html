<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cámara</title>

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 20px;
}

video, canvas {
  width: 100%;
  max-width: 360px;
  border-radius: 14px;
  margin-top: 10px;
}

button {
  padding: 12px 18px;
  margin: 8px;
  font-size: 16px;
  background: #000;
  color: #fff;
  border-radius: 8px;
  border: none;
}

</style>
</head>

<body>

<h3>Tomar foto</h3>

<video id="video" autoplay playsinline></video>
<canvas id="canvas" style="display:none;"></canvas>

<br>

<button onclick="abrirCamara()">Abrir cámara</button>
<button onclick="tomarFoto()">Tomar foto</button>
<button onclick="compartirFoto()">Compartir</button>

<a id="descargar" download="foto-con-logo.png" style="display:none;">Descargar imagen</a>

<script>
let video = document.getElementById("video");
let canvas = document.getElementById("canvas");
let descargar = document.getElementById("descargar");

function abrirCamara() {
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => video.srcObject = stream);
}

function tomarFoto() {
  canvas.style.display = "block";
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  let ctx = canvas.getContext("2d");

  // Dibuja la foto
  ctx.drawImage(video, 0, 0);

  // Agrega logo
  let logo = new Image();
  logo.src = "logo.png";
  logo.onload = () => {
    let logoWidth = canvas.width * 0.25;
    let logoHeight = logo.height * (logoWidth / logo.width);
    ctx.drawImage(
      logo,
      canvas.width - logoWidth - 15,
      canvas.height - logoHeight - 15,
      logoWidth,
      logoHeight
    );

    descargar.href = canvas.toDataURL("image/png");
    descargar.style.display = "block";
  };
}

function compartirFoto() {
  canvas.toBlob(blob => {
    let file = new File([blob], "foto.png", { type: "image/png" });

    if (navigator.share) {
      navigator.share({
        files: [file],
        title: "Mi foto",
        text: "Tomé esta foto"
      });
    } else {
      alert("Tu dispositivo no soporta compartir directo");
    }
  });
}
</script>

</body>
</html>


<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Momento Surreal – Desafío Dalí</title>

  <!-- Fuente Oswald -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      background: #000;
      font-family: 'Oswald', sans-serif;
      color: #fff;
      text-align: center;
    }

    .app {
      position: relative;
      max-width: 420px;
      margin: auto;
      padding-bottom: 12px;
    }

    video, canvas {
      width: 100%;
      border-radius: 18px;
      background: #000;
    }

    canvas {
      display: none;
    }

    /* LOGO */
    .top-bar {
      position: absolute;
      top: 20px;
      width: 100%;
      display: flex;
      justify-content: center;
      z-index: 10;
    }

    .logo {
      width: 150px;
      opacity: 0.95;
    }

    /* TEXTO */
    .overlay-text {
      position: absolute;
      top: 80px;
      width: 100%;
      font-size: 22px;
      font-style: italic;
      letter-spacing: 0.5px;
      z-index: 10;
      pointer-events: none;
      text-shadow: 0 2px 6px rgba(0,0,0,0.8);
    }

    /* BOTONES */
    button {
      background: #C4007A;
      color: #000;
      border: none;
      padding: 6px 14px;
      margin: 5px;
      font-size: 13px;
      border-radius: 16px;
      cursor: pointer;
    }

    .controls {
      margin-top: 8px;
    }
  </style>
</head>

<body>

<div class="app">

  <!-- LOGO -->
  <div class="top-bar">
    <img src="logo.png" class="logo" alt="Desafío Dalí">
  </div>

  <!-- TEXTO PREVIEW -->
  <div id="overlayText" class="overlay-text">
    Momento surreal en Desafío Dalí
  </div>

  <!-- VIDEO -->
  <video id="video" autoplay playsinline muted></video>
  <canvas id="canvas"></canvas>

  <!-- FRASES -->
  <div class="controls">
    <button onclick="setPhrase(0)">Frase 1</button>
    <button onclick="setPhrase(1)">Frase 1 · Oscuro</button>
    <button onclick="setPhrase(2)">Frase 2</button>
    <button onclick="setPhrase(3)">Frase 2 · Oscuro</button>
    <button onclick="setPhrase(4)">Frase 3</button>
    <button onclick="setPhrase(5)">Frase 3 · Oscuro</button>
  </div>

  <!-- ACCIONES -->
  <div class="controls">
    <button onclick="switchCamera()">Cambiar cámara</button>
    <button onclick="takePhoto()">Tomar foto</button>
  </div>

</div>

<script>
  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const overlay = document.getElementById("overlayText");

  const phrases = [
    { text: "Momento surreal en Desafío Dalí", color: "white" },
    { text: "Momento surreal en Desafío Dalí", color: "black" },
    { text: "Una experiencia fuera de la realidad", color: "white" },
    { text: "Una experiencia fuera de la realidad", color: "black" },
    { text: "Vive el genio surrealista", color: "white" },
    { text: "Vive el genio surrealista", color: "black" }
  ];

  let selectedPhrase = phrases[0];
  let currentFacingMode = "environment";
  let stream;

  function setPhrase(index) {
    selectedPhrase = phrases[index];
    overlay.innerText = selectedPhrase.text;
    overlay.style.color = selectedPhrase.color;
  }

  function startCamera() {
    if (stream) {
      stream.getTracks().forEach(track => track.stop());
    }

    navigator.mediaDevices.getUserMedia({
      video: { facingMode: currentFacingMode },
      audio: false
    })
    .then(s => {
      stream = s;
      video.srcObject = stream;
    })
    .catch(err => {
      alert("No se pudo acceder a la cámara");
      console.error(err);
    });
  }

  function switchCamera() {
    currentFacingMode = currentFacingMode === "user" ? "environment" : "user";
    startCamera();
  }

  function takePhoto() {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    ctx.drawImage(video, 0, 0);

    ctx.font = "italic 36px 'Oswald'";
    ctx.fillStyle = selectedPhrase.color;
    ctx.textAlign = "center";
    ctx.fillText(
      selectedPhrase.text,
      canvas.width / 2,
      70
    );

    const logo = new Image();
    logo.src = "logo.png";
    logo.onload = () => {
      const size = 180;
      ctx.drawImage(
        logo,
        canvas.width / 2 - size / 2,
        canvas.height / 2 - size / 2,
        size,
        size
      );

      canvas.style.display = "block";
      video.style.display = "none";
    };
  }

  // INICIAR
  startCamera();
</script>

</body>
</html>
